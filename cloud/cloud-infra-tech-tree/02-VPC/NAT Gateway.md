# NAT Gateway
NAT(네트워크 주소 변환) 서비스

프라이빗 서브넷의 인스턴스가 VPC 외부의 서비스에 연결할 수 있지만, 외부 서비스에서 이러한 인스턴스와 연결을 시작할 수 없도록 NAT Gateway를 사용할 수 있다

NAT Gateway의 연결 유형

- 퍼블릭(default)
 - 퍼블릭(default)
    - 프라이빗 서브넷의 인스턴스는 퍼블릭 NAT 게이트웨이를 통해 인터넷에 연결할 수 있지만 인터넷에서 원치 않는 인바운드 연결을 수신할 수 없다
    - 퍼블릭 서브넷에서 퍼블릭 NAT 게이트웨이를 생성하고, 생성 시 탄력적 IP 주소를 NAT 게이트웨이와 연결해야 한다
    - 트래픽을 NAT 게이트웨이에서 VPC용 인터넷 게이트웨이로 라우팅
    - 또는 퍼블릭 NAT 게이트웨이를 사용하여 다른 VPC 또는 온프레미스 네트워크에 연결할 수 있다 → NAT 게이트웨이에서 Transit Gateway 또는 가상 프라이빗 게이트웨이를 통해 트래픽을 라우팅
- 프라이빗
    - 프라이빗 서브넷의 인스턴스는 프라이빗 NAT 게이트웨이를 통해 다른 VPC 또는 온프레미스 네트워크에 연결할 수 있다
    - 트래픽을 NAT 게이트웨이에서 Transit Gateway 또는 가상 프라이빗 게이트웨이를 통해 트래픽을 라우팅할 수 있다
    - 탄력적 IP 주소를 프라이빗 NAT 게이트웨이에 연결할 수는 없다
    - 프라이빗 NAT 게이트웨이를 사용하여 VPC에 인터넷 게이트웨이를 연결할 수는 있지만, 프라이빗 NAT 게이트웨이에서 인터넷 게이트웨이로 트래픽을 라우팅하는 경우 인터넷 게이트웨이가 트래픽을 삭제
- NAT 게이트웨이는 인스턴스 소스 IP 주소를 NAT 게이트웨이의 IP 주소로 바꾼다
    - 퍼블릭 NAT 게이트웨이의 경우 → NAT 게이트웨이의 탄력적 IP 주소
    - 프라이빗 NAT 게이트웨이의 경우 → NAT 게이트웨이의 프라이빗 IP 주소
- 인스턴스에 응답 트래픽을 전송할 때 NAT 디바이스는 주소를 원래 소스 IP 주소로 다시 변환

## NAT 게이트웨이 기본 사항

- 각 NAT 게이트웨이는 특정 가용 영역에 생성되고 해당 영역에서 중복성을 통해 구현
    - 각 가용 영역에서 만들 수 있는 NAT 게이트웨이 개수에는 할당량이 있음
- 여러 가용 영역에 리소스가 있고 NAT 게이트웨이 하나를 공유하는 경우, NAT 게이트웨이의 가용 영역이 다운되면 다른 가용영역의 리소스도 인터넷에 액세스할 수 없게 된다
- 가용 영역과 독립적인 아키텍처를 만들려면 각 가용영역에 NAT 게이트웨이를 만들고 리소스가 동일한 가용 영역의 NAT 게이트웨이를 사용하도록 라우팅 구성
- **NAT 게이트웨이에 적용되는 특성 및 규칙**
    - TCP, UDP, ICMP 등의 프로토콜을 지원
    - IPv4, IPv6 트래픽에 대해 지원
    - NAT 게이트웨이는 5Gbps의 대역폭을 지원하며 최대 100Gbps까지 자동 확장
        - 더 많은 대역폭이 필요한 경우 리소스를 여러 서브넷으로 분할하고 각 서브넷에 NAT 게이트웨이를 만들 수 있다
    - NAT 게이트웨이는 초당 백만 개의 패킷을 처리할 수 있으며 초당 최대 천만 개의 패킷을 자동으로 확장할 수 있다 → 제한을 초과할 경우 NAT 게이트웨이가 패킷을 삭제
        - 패킷 손실을 방지하려면 리소스를 여러 서브넷으로 분할하고 각 서브넷에 대해 별도 NAT 게이트웨이 생성
    -


[NAT 게이트웨이 - Amazon Virtual Private Cloud](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/vpc-nat-gateway.html)

[NAT 게이트웨이 - Amazon Virtual Private Cloud](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/vpc-nat-gateway.html)